d1 $ every 7 (
  (# cut "0 3") .
  (degradeBy (wchoose [(1.3, 0.4), (0.35, 0.6)])) .
  (# accelerate "[0.4 0.6 [1.2 1.5 1.6] 0.9]/2") .
  (# delay (fromTo 0 0.37)) .
  (# delayt "[0.3 [0.05 0.1] <0.7 0.5> 0.8]") .
  (# delayfb (range 0.1 0.33 $ perlin)) .
  (# size (fromTo 0 0.26)) .
  (# room "0.14 0.22")
) $
stack [
  -- voice
  sometimesBy 0.42 ((density 4) . (fastAppend (s "trp1_fx:13" # gain 0.45))) $
  whenmod 5 3 ((# cut (wchoose [(2, 0.6), (0, 0.4)])) . (# speed "0.4 0.35 <1 0.4>")) $
  loopAt 1 $
  s "trp1_fx:10"
    # gain 0.76
  ,
  -- drone
  whenmod 4 3 (wchoose [(0.25, 0.25), (1.75, 0.25), (1.5, 0.25), (1.25, 0.25)] <~) $
  every 3 (# speed "0.4 <0.32 0.26 0.16> 0.96 0.87") $
  s "ag:6"
    # unit "c"
    # legato 0.6
    # cutoff 900
    # cut (wchoose [(2, 0.3), (0, 0.7)])
    # gain 0.8
  ,
  -- metal
  whenmod 3 2 ((hurry "0.2 0.5 2 6") . (# gain "1 1 0.92 0.86")) $
  s "bm:6*4"
    # gain 0.98
  ,
  -- hihat
  every 3 ((superimpose rev) . (# cut 1)) $
  within (0.2, 0.8) (ghost) $
  s "[grprc:5 _ [grprc:5 grprc:3 ~] grprc:3 [grprc:5*2 ~] grprc:5]*2"
    # speed "1.2 <3 2>"
    # pan 0.66
    # cut "0 1"
    # gain 0.89
  ,
  -- kick1
  sometimesBy 0.22 ((spin 2) . (slow "2 4")) $
  whenmod 4 3 ((degradeBy "[0.22 0.2 [0.15 0.7]]") . (# end "0.25 <0.5 0.75>")) $
  every 2 (fastappend (s "[tkc:5 sine:2 ~*2 tkc:5]*2" # cut 2 # gain 1.2)) $
  s "[tkc:5 sine:2 tkc:5*2 ~]*2"
    # cut 2
    # gain 1.1
  ,
  -- kick2
  whenmod 5 4 (within (0, 0.5) (stutWith "3 5 7" (range 0.125 56 $ rand) ((fastRepeatCycles 4) . (|* gain 0.8)))) $
  every 3 (wchoose [(0.2, 0.65), (0.8, 0.35)] ~>) $
  s "[~ d8k:7 ~ _ d8k:8]*4"
    # gain 0.98
  ,
  -- snare
  someCyclesBy 0.34 (densityGap "0.3 0.7 1.5") $
  s "~ brf:2*3 ~ brf:2"
    # gain 0.95
] # cps 0.2

d1 silence

d2 $ every 10 (
  fastAppend ( -- nappe
    every 4 (superimpose ((# start 0.25) . (rev))) $
    struct (ascii "<[a d] [c e h] f>") $
    sometimesBy 0.21 (fast "2 <1.3 0.5>") $
    fix ((# speed "<0.54 0.36>") . (# gain 0.48)) (s "trp1_fx:33") $
    s "trp1_fx:43 trp1_fx:33"
      # att 3.1
      # speed 0.33
      # hpf 118
      # cut "0 1 1"
      # gain 0.6
    )
) $
stack [
  -- kick
  whenmod 5 4 ((within (0, 0.5) (# cut "<0 1>")) . (within (0.5, 1) (chop "6 8"))) $
  every 3 (within (0.25, 1) (rev)) $
  fix (# gain 0.9) (s "trp2_fx:3") $
  s "~ trp2_fx trp1_8:9 trp2_fx:3"
    # gain 1
  ,
  -- hihat
  sometimesBy 0.24 (stutWith 4 (1/12) ((|* speed 0.5 ) . (slow "3 4 2"))) $
  whenmod 4 2 ((hurry "1.2 0.4 1.1 0.95")) $
  fix ((# begin 0.12) . (# att (range 0.1 0.9 $ slow 6 perlin)) . (# rel "1.2 2.5") . (# gain 0.8)) (s "trp2_h:2") $
  s "[trp2_h*3 [trp2_h:2 trp2_h]*2 [trp2_h:2 _ ~ trp2_h*5] ~ trp2_h:2*2 ~]*2"
    # rel 0.01
    # room "0.02 0.1 0.12 0.15 0.2"
    # gain 0.9
  ,
  -- clap
  every 4 (hurry "0.2 0.7 0.8") $
  every 2 (wchoose [(0.25, 0.25), (1.75, 0.5), (0.5, 0.25)] ~>) $
  chop 8 $
  s "trp1_p:24*4"
    # rel "0.02 0.11 0.01 0.14"
    # gain 0.86
  ,
  -- fx
  sometimesBy 0.4 ((density 24) . (# rel "0.02 0.2 0.15 0.01")) $
  foldEvery [3, 5] (0.5 ~>) $
  degradeBy 0.8 $
  s "trp4_fx:8(5, 4, 2)"
    # gain 0.58
  ,
  -- cloche folle
  whenmod 5 3 (const $ s "~") $
  s "trp3_fx:2*2"
    # rel 2
    # gain 0.72
] # cps 0.2

d2 silence

d3 $ somecyclesBy 0.21 ((# squiz "2 4 10") . (# accelerate "1.87 2.54 <1.2 3.12>") . (# gain 0.72)) $
stack [
  -- ambi
  whenmod 6 4 ((struct (binaryN 7 29)) . (# cut 1)) $
  superimpose (loopAt 1) $
  s "{trp1_fx:26}%1.75"
    # speed 0.97
    # end "0.7 0.8 0.3 0.2 0.01 0.04 0.6"
    # room "0.1 0.3 0.24"
    # size "0.03 0.07 0.2 0.36"
    # gain 0.76
  ,
  -- kick
  whenmod 5 3 (# cutoff (range 237 6554 $ fast 2.5 square)) $
  every 12 (slow 2) $
  every 3 (0.25 ~>) $
  every 2 (1.5 <~) $
  fix (# gain 0.92) (s "trp3_8:1") $
  s "{[~ trp1_k:8 _ trp3_8:4 _, ~ trp1_k:31 _]}%3.5"
    # cut 1
    # gain 1
  ,
  -- voice
  every 5 (stutWith 3 (1/32) (|* speed 0.6)) $
  (0.75 <~) $
  s "{trp2_fx:10 ~ trp2_fx:8, ~ trp2_fx:8}%1.75"
    # size "0.2 0.4 0.02 0.6"
    # room "0.1 0.5 0.03"
    # gain 0.65
  ,
  -- hihat
  sometimesBy 0.3 (superimpose ((0.75 ~>) . (# s "{[~ trp1_h:16 ~, trp1_h:16*3 _, trp1_h:16 ~ trp1_h:16*2 _ trp1_h:16*2]}%1.75") . (within (0.2, 0.8) (rev)))) $
  s "{[~ trp1_h:16 ~ trp1_h:16*3 _, trp1_h:16 ~ trp1_h:16*2 _ trp1_h:16*2]}%1.75"
    # pan (range 0.55 1 $ fast 3 cosine) -- 0.75
    # rel 0.0098
    # gain 0.88
  ,
  -- nappe
  whenmod 5 3 ((degradeBy 0.3) . (fast "2 0.7 0.4") . (spin "3 1.8 0.21")) $
  sometimesBy 0.65 (degradeBy 0.8) $
  s "{~ atm ~*5}%3.5"
    # att 1.32
    # rel 3.7
    # gain 0.65
] # cps 0.27

d3 silence

d4 $ whenmod 9 7 ((hurry "0.5 1.4 3 1.6 0.3") . (# binshift "0.2 0.7 0.52 0.34") . (# gain 0.7)) $
stack [
  -- nappe
  every 4 (# speed "0.2 0.4 2.3") $
  whenmod 5 4 (fast "2 1.7 1.9 4") $
  s "trp2_fx:10"
    # speed 0.1
    # cut "1 0"
    # gain 0.65
  ,
  -- perc
  s "~ _ tempp:1"
    # gain 1
  ,
  -- noise
  whenmod 6 5 ((0.5 ~>) . (slow "2 1.8") . (# fshift "200 609 7341 509") . (# fshiftphase "3 0.2 0.5 4")) $
  slow 2 $
  every 5 rev $
  fix (# gain 0.48) (s "trp4_fx:1") $
  s "trp4_fx:1 _ ~ trp3_fx:22 _"
    # att "0.01 2 1.8 0.3 1.4 0.23"
    # rel "0.9 1.4 2.3 2.1 0.83"
    # cut "1 0 1 0 0"
    # gain 0.63
  ,
  -- kick
  whenmod 7 5 ((hurry "0.3 0.2 1.7") . (density "<2 1.5>") . (# gain 0.9)) $
  every 3 (wchoose [(0.25, 0.6), (0.5, 0.4)] <~) $
  fix (# start 0.1) (s "trp2_k:25") $
  s "[[trp2_b:2 ~ trp1_k:8] _ trp2_b:5 ~, ~ [trp3_k:26 ~] trp2_b ~, trp2_b:2 tempk:5]"
    # cut 2
    # gain 0.96
  ,
  -- snare
  every 4 ((fast "<1.42 0.2>") . (randslice "<32 92> 28")) $
  swingBy (1/6) 4 $
  s "[~ claps:1 [trp2_p:6 claps:19] ~]"
    # octer "1 1 2 1"
    # octersub 3
    # octersubsub 6
    # rel 0.34
    # gain 0.66
  ,
  -- hihat
  whenmod 7 5 (degradeBy 0.4) $
  every 5 (superimpose rev) $
  every 4 palindrome $
  every 3 (0.75 ~>) $
  ghost $
  s "[dgh:2 dgh:4*2 dgh:6 dgh:4 dgh:6*2]*2"
    # rel "0.2 0.01 0.24 0.015 0.1 0.02"
    # pan (range 0 1 $ fast 8 rand)
    # gain 0.57
] # cps 0.7

d4 silence

d5 $ whenmod 10 8 ((scramble "2 4 8") . (hurry (fromTo 2 0.5)). (# gain 0.78)) $
stack [
  -- kick
  every 4 ((spin "0.5 <0.25 0.125>") . (# scram "<0.62 0.54> <0.76 0.83>") . (# gain 0.6)) $
  every 5 ((fast "1 <4 0.5>") . rev) $
  fix (# binshift 0.2) (s "ek") $
  fix (# gain 0.99) (s "trp2_b:2") $
  s "[trp2_b:2 _ ~ ek [trp2_b:7 ek:7]]"
    # cut 1
    # gain 1.1
  ,
  -- snare
  sometimesBy 0.32 (within (0.25, 0.75) (hurry "4 2 3")) $
  every 4 (0.125 ~>) $
  swingBy (1/8) "0.3 <0.15 0.6>" $
  ghost' 0.23 $
  s "[~ trp2_p:18] _ ~"
    # gain 0.79
  ,
  -- claps
  every 4 (stutWith 6 (1/"<8 16>") (|* binshift 0.5)) $
  every 4 (0.5 <~) $
  s "~ ugclap:17"
    # shape 0.3
    # gain 0.68
  ,
  -- hihat
  loopAt 1 $
  s "trp2_fx:5*4"
   # hpf 560
   # lpf 687
   # gain 0.69
  ,
  -- ambi
  someCyclesBy 0.4 (const $ s "~") $
  fastCat [
    (s "pl:27/4" # speed 0.4 # gain 0.67),
    (
      s "sphere:1"
        # speed 1.2
        # rel "0.9 1.4"
        # cut (wchoose[(1, 0.6), (0, 0.4)])
        # gain 0.76
    )
  ]
] # cps 0.61

d5 silence

d6 $ whenmod 16 14 ((scramble "6 2 4") . (# cut 2) . (# smear "0.2 0.5 0.9")) $
stack [
  -- ambi
  whenmod 5 4 (densityGap "2 0.8 4 6") $
  every 3 (# accelerate "<6 5> <4 10> 8") $
  s "[trp2_h:2*4]*4"
    # lpf 500
    # start 0.03
    # cut 1
    # gain (1*1)
  ,
  -- nappe
  fast "<2 3>" $
  s "ade:9 _"
    # speed 0.5
    # gain (0.7*1)
  ,
  -- ambi
  every 8 ((# scram "1.3 <0.3 1.8>") . palindrome) $
  s "<af:3 af:5 af:12>"
    # speed "0.8 0.7 0.4"
    # phasdp "0.6 0.2 0.8"
    # phaserrate "0.4 1.2 0.2 0.9"
    # gain (0.8*1)
  ,
  -- noise
  s "pss/<1 2>"
    # gain 1.4
  ,
  -- snare
  every 4 ((within (0.7, 1) (density 4)) . (0.125 ~>)) $
  s "~*2 ag:8"
    # note (scale "minor" $ "<8 9 14>")
    # gain (0.98*1)
  ,
  -- kick1
  whenmod 4 3 (hurry "2 <3 4> 0.8") $
  every 2 (within (0.5, 1) (# start 2)) $
  fast "8 14 16" $
  s "~ ai:2"
    # start 1
    # rel "0.01 0.3 0.02"
    # gain 0.84
  ,
  -- kick2
  every 4 (within (0, 0.75) (fast 3)) $
  s "dgk dgk:5 dgk*2"
    # gain 1
] # cps 0.46

d6 silence

hush
